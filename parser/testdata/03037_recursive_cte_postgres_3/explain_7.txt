-- Generated by ClickHouse 25.8.13.73
SelectWithUnionQuery (children 1)
 ExpressionList (children 1)
  SelectQuery (children 5)
   ExpressionList (children 1)
    WithElement (children 1)
     Subquery (children 1)
      SelectWithUnionQuery (children 1)
       ExpressionList (children 2)
        SelectQuery (children 1)
         ExpressionList (children 2)
          Literal UInt64_1 (alias id)
          Function CAST (alias path) (children 1)
           ExpressionList (children 2)
            Literal \'[]\'
            Literal \'Array(UInt64)\'
        SelectQuery (children 2)
         ExpressionList (children 2)
          Identifier tree.id
          Function arrayConcat (children 1)
           ExpressionList (children 2)
            Identifier t.path
            Function array (children 1)
             ExpressionList (children 1)
              Identifier tree.id
         TablesInSelectQuery (children 2)
          TablesInSelectQueryElement (children 1)
           TableExpression (children 1)
            TableIdentifier tree
          TablesInSelectQueryElement (children 2)
           TableExpression (children 1)
            TableIdentifier t
           TableJoin (children 1)
            Function equals (children 1)
             ExpressionList (children 2)
              Identifier tree.parent_id
              Identifier t.id
   ExpressionList (children 2)
    Identifier t1.id
    Function count (children 1)
     ExpressionList (children 1)
      Identifier t2.path
   TablesInSelectQuery (children 2)
    TablesInSelectQueryElement (children 1)
     TableExpression (children 1)
      TableIdentifier t (alias t1)
    TablesInSelectQueryElement (children 2)
     TableExpression (children 1)
      TableIdentifier t (alias t2)
     TableJoin (children 1)
      Function and (children 1)
       ExpressionList (children 3)
        Function equals (children 1)
         ExpressionList (children 2)
          Function arrayElement (children 1)
           ExpressionList (children 2)
            Identifier t1.path
            Literal UInt64_1
          Function arrayElement (children 1)
           ExpressionList (children 2)
            Identifier t2.path
            Literal UInt64_1
        Function equals (children 1)
         ExpressionList (children 2)
          Function length (children 1)
           ExpressionList (children 1)
            Identifier t1.path
          Literal UInt64_1
        Function greater (children 1)
         ExpressionList (children 2)
          Function length (children 1)
           ExpressionList (children 1)
            Identifier t2.path
          Literal UInt64_1
   ExpressionList (children 1)
    Identifier t1.id
   ExpressionList (children 1)
    OrderByElement (children 1)
     Identifier t1.id
