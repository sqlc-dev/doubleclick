CreateQuery test_table (children 3)
 Identifier test_table
 Storage definition (children 2)
  Function MergeTree
  Identifier a
 SelectWithUnionQuery (children 1)
  ExpressionList (children 1)
   SelectQuery (children 3)
    ExpressionList (children 2)
     Identifier a_table.a
     Identifier b_table.b_arr
    TablesInSelectQuery (children 2)
     TablesInSelectQueryElement (children 1)
      TableExpression (children 1)
       Subquery (alias a_table) (children 1)
        SelectWithUnionQuery (children 1)
         ExpressionList (children 1)
          SelectQuery (children 1)
           ExpressionList (children 1)
            Function arrayJoin (alias a) (children 1)
             ExpressionList (children 1)
              Function range (children 1)
               ExpressionList (children 1)
                Literal UInt64_10000
     TablesInSelectQueryElement (children 2)
      TableExpression (children 1)
       Subquery (alias b_table) (children 1)
        SelectWithUnionQuery (children 1)
         ExpressionList (children 1)
          SelectQuery (children 1)
           ExpressionList (children 1)
            Function range (alias b_arr) (children 1)
             ExpressionList (children 1)
              Literal UInt64_10000
      TableJoin
    Set
The query succeeded but the server error '241' was expected (query: EXPLAIN AST create table test_table engine MergeTree order by a as select a_table.a, b_table.b_arr from (select arrayJoin(range(10000)) as a) a_table cross join (select range(10000) as b_arr) b_table settings max_memory_usage = 1; -- { serverError MEMORY_LIMIT_EXCEEDED }).
