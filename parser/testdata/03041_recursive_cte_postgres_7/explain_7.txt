SelectWithUnionQuery (children 1)
 ExpressionList (children 1)
  SelectQuery (children 3)
   ExpressionList (children 2)
    WithElement (children 1)
     Subquery (children 1)
      SelectWithUnionQuery (children 1)
       ExpressionList (children 1)
        SelectQuery (children 2)
         ExpressionList (children 1)
          Asterisk
         TablesInSelectQuery (children 1)
          TablesInSelectQueryElement (children 1)
           TableExpression (children 1)
            Function values (children 1)
             ExpressionList (children 7)
              Literal \'id_key UInt64, link UInt64\'
              Literal Tuple_(UInt64_1, UInt64_17)
              Literal Tuple_(UInt64_2, UInt64_17)
              Literal Tuple_(UInt64_3, UInt64_17)
              Literal Tuple_(UInt64_4, UInt64_17)
              Literal Tuple_(UInt64_6, UInt64_17)
              Literal Tuple_(UInt64_5, UInt64_17)
    WithElement (children 1)
     Subquery (children 1)
      SelectWithUnionQuery (children 1)
       ExpressionList (children 3)
        SelectQuery (children 1)
         ExpressionList (children 3)
          Literal UInt64_0 (alias id_key)
          Literal \'base\' (alias row_type)
          Literal UInt64_17 (alias link)
        SelectQuery (children 3)
         ExpressionList (children 3)
          WithElement (children 1)
           Subquery (children 1)
            SelectWithUnionQuery (children 1)
             ExpressionList (children 1)
              SelectQuery (children 3)
               ExpressionList (children 4)
                Identifier tab.id_key (alias id_key)
                Function CAST (alias row_type) (children 1)
                 ExpressionList (children 2)
                  Literal \'true\'
                  Literal \'text\'
                Identifier iter.link (alias link)
                Function MIN (alias min) (children 1)
                 ExpressionList (children 1)
                  Identifier tab.id_key
               TablesInSelectQuery (children 2)
                TablesInSelectQueryElement (children 1)
                 TableExpression (children 1)
                  TableIdentifier tab
                TablesInSelectQueryElement (children 2)
                 TableExpression (children 1)
                  TableIdentifier iter
                 TableJoin (children 1)
                  ExpressionList (children 1)
                   Identifier link
               Function greater (children 1)
                ExpressionList (children 2)
                 Identifier tab.id_key
                 Identifier iter.id_key
          WithElement (children 1)
           Subquery (children 1)
            SelectWithUnionQuery (children 1)
             ExpressionList (children 1)
              SelectQuery (children 3)
               ExpressionList (children 3)
                Identifier id_key
                Identifier row_type
                Identifier link
               TablesInSelectQuery (children 1)
                TablesInSelectQueryElement (children 1)
                 TableExpression (children 1)
                  TableIdentifier remaining
               Function equals (children 1)
                ExpressionList (children 2)
                 Identifier id_key
                 Identifier min
          WithElement (children 1)
           Subquery (children 1)
            SelectWithUnionQuery (children 1)
             ExpressionList (children 1)
              SelectQuery (children 3)
               ExpressionList (children 3)
                Identifier tab.id_key (alias id_key)
                Function CAST (alias row_type) (children 1)
                 ExpressionList (children 2)
                  Literal \'new\'
                  Literal \'text\'
                Identifier tab.link (alias link)
               TablesInSelectQuery (children 2)
                TablesInSelectQueryElement (children 1)
                 TableExpression (children 1)
                  TableIdentifier first_remaining (alias e)
                TablesInSelectQueryElement (children 2)
                 TableExpression (children 1)
                  TableIdentifier tab
                 TableJoin (children 1)
                  Function equals (children 1)
                   ExpressionList (children 2)
                    Identifier e.id_key
                    Identifier tab.id_key
               Function equals (children 1)
                ExpressionList (children 2)
                 Identifier e.row_type
                 Literal \'false\'
         ExpressionList (children 1)
          Asterisk
         TablesInSelectQuery (children 1)
          TablesInSelectQueryElement (children 1)
           TableExpression (children 1)
            TableIdentifier first_remaining
        SelectQuery (children 3)
         ExpressionList (children 1)
          Asterisk
         TablesInSelectQuery (children 1)
          TablesInSelectQueryElement (children 1)
           TableExpression (children 1)
            TableIdentifier effect
         ExpressionList (children 3)
          WithElement (children 1)
           Subquery (children 1)
            SelectWithUnionQuery (children 1)
             ExpressionList (children 1)
              SelectQuery (children 3)
               ExpressionList (children 4)
                Identifier tab.id_key (alias id_key)
                Function CAST (alias row_type) (children 1)
                 ExpressionList (children 2)
                  Literal \'true\'
                  Literal \'text\'
                Identifier iter.link (alias link)
                Function MIN (alias min) (children 2)
                 ExpressionList (children 1)
                  Identifier tab.id_key
                 WindowDefinition
               TablesInSelectQuery (children 2)
                TablesInSelectQueryElement (children 1)
                 TableExpression (children 1)
                  TableIdentifier tab
                TablesInSelectQueryElement (children 2)
                 TableJoin (children 1)
                  ExpressionList (children 1)
                   Identifier link
                 TableExpression (children 1)
                  TableIdentifier iter
               Function greater (children 1)
                ExpressionList (children 2)
                 Identifier tab.id_key
                 Identifier iter.id_key
          WithElement (children 1)
           Subquery (children 1)
            SelectWithUnionQuery (children 1)
             ExpressionList (children 1)
              SelectQuery (children 3)
               ExpressionList (children 3)
                Identifier id_key
                Identifier row_type
                Identifier link
               TablesInSelectQuery (children 1)
                TablesInSelectQueryElement (children 1)
                 TableExpression (children 1)
                  TableIdentifier remaining
               Function equals (children 1)
                ExpressionList (children 2)
                 Identifier id_key
                 Identifier min
          WithElement (children 1)
           Subquery (children 1)
            SelectWithUnionQuery (children 1)
             ExpressionList (children 1)
              SelectQuery (children 3)
               ExpressionList (children 3)
                Identifier tab.id_key (alias id_key)
                Function CAST (alias row_type) (children 1)
                 ExpressionList (children 2)
                  Literal \'new\'
                  Literal \'text\'
                Identifier tab.link (alias link)
               TablesInSelectQuery (children 2)
                TablesInSelectQueryElement (children 1)
                 TableExpression (children 1)
                  TableIdentifier first_remaining (alias e)
                TablesInSelectQueryElement (children 2)
                 TableJoin (children 1)
                  Function equals (children 1)
                   ExpressionList (children 2)
                    Identifier e.id_key
                    Identifier tab.id_key
                 TableExpression (children 1)
                  TableIdentifier tab
               Function equals (children 1)
                ExpressionList (children 2)
                 Identifier e.row_type
                 Literal \'false\'
   ExpressionList (children 1)
    Asterisk
   TablesInSelectQuery (children 1)
    TablesInSelectQueryElement (children 1)
     TableExpression (children 1)
      TableIdentifier iter
