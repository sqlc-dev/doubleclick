{
  "view": "view",
  "materialized": true,
  "to": "dst",
  "columns": [
    {
      "name": "block_timestamp",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "max"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "DateTime",
                "parameters": [
                  {
                    "type": "String",
                    "value": "UTC"
                  }
                ],
                "has_parentheses": true
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "block_hash",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "FixedString",
                "parameters": [
                  {
                    "type": "Integer",
                    "value": 32
                  }
                ],
                "has_parentheses": true
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "block_number",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "UInt256"
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "deployer",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "FixedString",
                "parameters": [
                  {
                    "type": "Integer",
                    "value": 20
                  }
                ],
                "has_parentheses": true
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "address",
      "type": {
        "name": "FixedString",
        "parameters": [
          {
            "type": "Integer",
            "value": 20
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "name",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "String"
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "symbol",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "String"
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "decimals",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "UInt8"
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "is_proxy",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "Bool"
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "blacklist_flags",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Array",
            "parameters": [
              {
                "name": "Nullable",
                "parameters": [
                  {
                    "name": "String"
                  }
                ],
                "has_parentheses": true
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "whitelist_flags",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Array",
            "parameters": [
              {
                "name": "Nullable",
                "parameters": [
                  {
                    "name": "String"
                  }
                ],
                "has_parentheses": true
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "detected_standards",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Array",
            "parameters": [
              {
                "name": "Nullable",
                "parameters": [
                  {
                    "name": "String"
                  }
                ],
                "has_parentheses": true
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "amended_type",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "String"
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "comment",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Nullable",
            "parameters": [
              {
                "name": "String"
              }
            ],
            "has_parentheses": true
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "_sources",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "groupUniqArray"
            ]
          },
          {
            "name": "String"
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "_updated_at",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "max"
            ]
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    },
    {
      "name": "_active",
      "type": {
        "name": "AggregateFunction",
        "parameters": [
          {
            "parts": [
              "argMax"
            ]
          },
          {
            "name": "Bool"
          },
          {
            "name": "DateTime",
            "parameters": [
              {
                "type": "String",
                "value": "UTC"
              }
            ],
            "has_parentheses": true
          }
        ],
        "has_parentheses": true
      }
    }
  ],
  "as_select": {
    "selects": [
      {
        "with": [
          {
            "name": "default_timestamp",
            "query": {
              "query": {
                "selects": [
                  {
                    "columns": [
                      {
                        "name": "toDateTime",
                        "arguments": [
                          {
                            "type": "String",
                            "value": "1970-01-01 00:00:00"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            },
            "scalar_with": true
          }
        ],
        "columns": [
          {
            "name": "maxState",
            "arguments": [
              {
                "expr": {
                  "parts": [
                    "block_timestamp"
                  ]
                },
                "type": {
                  "name": "Nullable(DateTime('UTC'))"
                }
              }
            ],
            "alias": "block_timestamp"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "parts": [
                    "block_hash"
                  ]
                },
                "type": {
                  "name": "Nullable(FixedString(32))"
                }
              },
              {
                "parts": [
                  "insertion_time"
                ]
              }
            ],
            "alias": "block_hash"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "parts": [
                    "block_number"
                  ]
                },
                "type": {
                  "name": "Nullable(UInt256)"
                }
              },
              {
                "parts": [
                  "insertion_time"
                ]
              }
            ],
            "alias": "block_number"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "parts": [
                    "deployer"
                  ]
                },
                "type": {
                  "name": "Nullable(FixedString(20))"
                }
              },
              {
                "parts": [
                  "insertion_time"
                ]
              }
            ],
            "alias": "deployer"
          },
          {
            "parts": [
              "address"
            ]
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "Null",
                  "value": null
                },
                "type": {
                  "name": "Nullable(String)"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "name"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "Null",
                  "value": null
                },
                "type": {
                  "name": "Nullable(String)"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "symbol"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "Null",
                  "value": null
                },
                "type": {
                  "name": "Nullable(UInt8)"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "decimals"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "Boolean",
                  "value": true
                },
                "type": {
                  "name": "Nullable(Boolean)"
                }
              },
              {
                "parts": [
                  "insertion_time"
                ]
              }
            ],
            "alias": "is_proxy"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "String",
                  "value": "[]"
                },
                "type": {
                  "name": "Array(Nullable(String))"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "blacklist_flags"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "String",
                  "value": "[]"
                },
                "type": {
                  "name": "Array(Nullable(String))"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "whitelist_flags"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "String",
                  "value": "[]"
                },
                "type": {
                  "name": "Array(Nullable(String))"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "detected_standards"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "Null",
                  "value": null
                },
                "type": {
                  "name": "Nullable(String)"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "amended_type"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "expr": {
                  "type": "Null",
                  "value": null
                },
                "type": {
                  "name": "Nullable(String)"
                }
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "comment"
          },
          {
            "name": "groupUniqArrayState",
            "arguments": [
              {
                "type": "String",
                "value": "tokens_proxy_deployments"
              }
            ],
            "alias": "_sources"
          },
          {
            "name": "maxState",
            "arguments": [
              {
                "parts": [
                  "insertion_time"
                ]
              }
            ],
            "alias": "_updated_at"
          },
          {
            "name": "argMaxState",
            "arguments": [
              {
                "type": "Boolean",
                "value": true
              },
              {
                "expr": {
                  "parts": [
                    "default_timestamp"
                  ]
                },
                "type": {
                  "name": "DateTime('UTC')"
                }
              }
            ],
            "alias": "_active"
          }
        ],
        "from": {
          "tables": [
            {
              "table": {
                "table": {
                  "table": "test"
                }
              }
            }
          ]
        },
        "where": {
          "left": {
            "parts": [
              "insertion_time"
            ]
          },
          "op": "\u003e",
          "right": {
            "name": "toDateTime",
            "arguments": [
              {
                "type": "String",
                "value": "2024-03-14 11:38:09"
              }
            ]
          }
        },
        "group_by": [
          {
            "parts": [
              "address"
            ]
          }
        ]
      }
    ]
  }
}
