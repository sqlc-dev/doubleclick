SelectWithUnionQuery (children 1)
 ExpressionList (children 1)
  SelectQuery (children 2)
   ExpressionList (children 1)
    Function count (children 1)
     ExpressionList
   TablesInSelectQuery (children 1)
    TablesInSelectQueryElement (children 1)
     TableExpression (children 1)
      Subquery (children 1)
       SelectWithUnionQuery (children 1)
        ExpressionList (children 1)
         SelectQuery (children 2)
          ExpressionList (children 1)
           Identifier customers.customer_id (alias dim_customers_id)
          TablesInSelectQuery (children 3)
           TablesInSelectQueryElement (children 1)
            TableExpression (children 1)
             TableIdentifier b_orders (alias orders)
           TablesInSelectQueryElement (children 2)
            TableExpression (children 1)
             TableIdentifier b_customers (alias customers)
            TableJoin (children 1)
             Function equals (children 1)
              ExpressionList (children 2)
               Identifier orders.order_id
               Identifier customers.first_order_id
           TablesInSelectQueryElement (children 2)
            TableExpression (children 1)
             TableIdentifier b_addresses (alias shipping_addresses)
            TableJoin (children 1)
             Function equals (children 1)
              ExpressionList (children 2)
               Identifier shipping_addresses.address_id
               Identifier orders.address_id
